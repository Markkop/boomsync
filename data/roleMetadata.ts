import { RoleMetadata, ConditionInteraction } from '../types';

// Dependency triggers - roles that auto-pull other roles
export const DEPENDENCY_TRIGGERS: Record<string, string[]> = {
  'Ahab': ['Moby'],
  'Moby': ['Ahab'],
  'Romeo': ['Juliet'],
  'Juliet': ['Romeo'],
  'Wife': ['Mistress'],
  'Mistress': ['Wife'],
  'Blue Drone': ['Red Fist'],
  'Red Fist': ['Blue Drone'],
  'Sniper': ['Target', 'Decoy'],
  'Target': ['Sniper', 'Decoy'],
  'Decoy': ['Sniper', 'Target'],
  'Doctor': ['Engineer'],  // High-probability for game balance
  'Engineer': ['Doctor'],
  'Nurse': ['Doctor'],
  'Tinkerer': ['Engineer'],
  "President's Daughter": ['President'],
  'Martyr': ['Bomber'],
};

// Burying mode auto-includes
export const BURY_REQUIRED = ['Martyr', "President's Daughter"];

// Condition interactions
export const CONDITION_INTERACTIONS: ConditionInteraction[] = [
  { conditionA: 'Shy', conditionB: 'Foolish', result: 'cancel', description: 'Conditions cancel out' },
  { conditionA: 'Coy', conditionB: 'Foolish', result: 'cancel', description: 'Conditions cancel out' },
  { conditionA: 'Honest', conditionB: 'Liar', result: 'cancel', description: 'Conditions cancel out' },
  { conditionA: 'Immune', conditionB: '*', result: 'blocked', description: 'Immune unaffected by all' },
  { conditionA: 'Agent Power', conditionB: 'Shy Guy', result: 'blocked', description: 'Power wasted' },
];

// Role metadata - comprehensive taxonomy
export const ROLE_METADATA: Record<string, RoleMetadata> = {
  // Primary and Support Personnel
  'President': {
    name: 'President',
    team: 'blue',
    difficulty: 1,
    category: 'primary',
    mechanicalFunction: 'Primary win condition; must avoid the Bomber',
    dependencies: [],
    worksWellWith: [],
    incompatibleWith: [],
  },
  'Bomber': {
    name: 'Bomber',
    team: 'red',
    difficulty: 1,
    category: 'primary',
    mechanicalFunction: 'Primary win condition; must locate the President',
    dependencies: [],
    worksWellWith: [],
    incompatibleWith: [],
  },
  'Blue Team': {
    name: 'Blue Team',
    team: 'blue',
    difficulty: 1,
    category: 'primary',
    mechanicalFunction: 'Standard rank-and-file; provides "chaff" for protection',
    dependencies: [],
    worksWellWith: [],
    incompatibleWith: [],
  },
  'Red Team': {
    name: 'Red Team',
    team: 'red',
    difficulty: 1,
    category: 'primary',
    mechanicalFunction: 'Standard rank-and-file; provides "chaff" for deception',
    dependencies: [],
    worksWellWith: [],
    incompatibleWith: [],
  },
  'Doctor': {
    name: 'Doctor',
    team: 'blue',
    difficulty: 2,
    category: 'support',
    mechanicalFunction: 'Must card-share with President ("Health Loop")',
    dependencies: [],
    worksWellWith: ['Engineer', 'Nurse'],
    incompatibleWith: [],
  },
  'Engineer': {
    name: 'Engineer',
    team: 'red',
    difficulty: 2,
    category: 'support',
    mechanicalFunction: 'Must card-share with Bomber',
    dependencies: [],
    worksWellWith: ['Doctor', 'Tinkerer'],
    incompatibleWith: [],
  },
  'Nurse': {
    name: 'Nurse',
    team: 'blue',
    difficulty: 2,
    category: 'support',
    mechanicalFunction: 'Backup for Doctor',
    dependencies: ['Doctor'],
    worksWellWith: ['Doctor'],
    incompatibleWith: [],
  },
  'Tinkerer': {
    name: 'Tinkerer',
    team: 'red',
    difficulty: 2,
    category: 'support',
    mechanicalFunction: 'Backup for Engineer',
    dependencies: ['Engineer'],
    worksWellWith: ['Engineer'],
    incompatibleWith: [],
  },
  "President's Daughter": {
    name: "President's Daughter",
    team: 'blue',
    difficulty: 2,
    category: 'backup',
    mechanicalFunction: 'Backup MVP for burying',
    dependencies: ['President'],
    worksWellWith: ['Martyr'],
    incompatibleWith: [],
  },
  'Martyr': {
    name: 'Martyr',
    team: 'red',
    difficulty: 2,
    category: 'backup',
    mechanicalFunction: 'Activates if Bomber is buried',
    dependencies: ['Bomber'],
    worksWellWith: ["President's Daughter"],
    incompatibleWith: [],
  },
  
  // Information Manipulation Roles
  'Spy': {
    name: 'Spy',
    team: 'both',
    difficulty: 2,
    category: 'info',
    mechanicalFunction: 'Card color inverse of actual team',
    dependencies: [],
    worksWellWith: ['Coy Boy', 'Shy Guy'],
    incompatibleWith: [],
    minPlayers: 11,
  },
  'Coy Boy': {
    name: 'Coy Boy',
    team: 'both',
    difficulty: 2,
    category: 'info',
    mechanicalFunction: 'May only share card color',
    dependencies: [],
    worksWellWith: ['Spy', 'Shy Guy'],
    incompatibleWith: [],
    minPlayers: 11,
  },
  'Shy Guy': {
    name: 'Shy Guy',
    team: 'both',
    difficulty: 2,
    category: 'info',
    mechanicalFunction: 'Cannot share any part of card',
    dependencies: [],
    worksWellWith: ['Spy', 'Coy Boy'],
    incompatibleWith: [],
  },
  'Negotiator': {
    name: 'Negotiator',
    team: 'both',
    difficulty: 2,
    category: 'info',
    mechanicalFunction: 'Can trade card info or force reveals',
    dependencies: [],
    worksWellWith: ['Spy', 'Coy Boy'],
    incompatibleWith: [],
  },
  'Agent': {
    name: 'Agent',
    team: 'both',
    difficulty: 3,
    category: 'info',
    mechanicalFunction: 'Can force immediate card share',
    dependencies: [],
    worksWellWith: [],
    incompatibleWith: ['Shy Guy'],
  },
  'Criminal': {
    name: 'Criminal',
    team: 'both',
    difficulty: 2,
    category: 'info',
    mechanicalFunction: 'Paired with Psychologist; has condition rules',
    dependencies: [],
    worksWellWith: ['Psychologist'],
    incompatibleWith: [],
  },
  'Psychologist': {
    name: 'Psychologist',
    team: 'blue',
    difficulty: 2,
    category: 'info',
    mechanicalFunction: 'Can remove negative conditions',
    dependencies: [],
    worksWellWith: ['Criminal'],
    incompatibleWith: [],
  },
  'Enforcer': {
    name: 'Enforcer',
    team: 'both',
    difficulty: 3,
    category: 'info',
    mechanicalFunction: 'Can force two players to card-share',
    dependencies: [],
    worksWellWith: [],
    incompatibleWith: [],
  },
  
  // Grey Team Dynamics
  'Gambler': {
    name: 'Gambler',
    team: 'grey',
    difficulty: 1,
    category: 'grey',
    mechanicalFunction: 'Must predict winning team',
    dependencies: [],
    worksWellWith: [],
    incompatibleWith: [],
  },
  'MI6': {
    name: 'MI6',
    team: 'grey',
    difficulty: 3,
    category: 'grey',
    mechanicalFunction: 'Must predict winner AND MVP locations',
    dependencies: [],
    worksWellWith: [],
    incompatibleWith: [],
  },
  'Ahab': {
    name: 'Ahab',
    team: 'grey',
    difficulty: 2,
    category: 'grey',
    mechanicalFunction: 'Rivalry; must ensure Moby is "dead"',
    dependencies: ['Moby'],
    worksWellWith: [],
    incompatibleWith: [],
  },
  'Moby': {
    name: 'Moby',
    team: 'grey',
    difficulty: 2,
    category: 'grey',
    mechanicalFunction: 'Rivalry; must ensure Ahab is "dead"',
    dependencies: ['Ahab'],
    worksWellWith: [],
    incompatibleWith: [],
  },
  'Wife': {
    name: 'Wife',
    team: 'grey',
    difficulty: 2,
    category: 'grey',
    mechanicalFunction: 'Must end in same room as President',
    dependencies: ['Mistress'],
    worksWellWith: [],
    incompatibleWith: ['Mistress'],
  },
  'Mistress': {
    name: 'Mistress',
    team: 'grey',
    difficulty: 2,
    category: 'grey',
    mechanicalFunction: 'Must end in same room as President',
    dependencies: ['Wife'],
    worksWellWith: [],
    incompatibleWith: ['Wife'],
  },
  'Romeo': {
    name: 'Romeo',
    team: 'grey',
    difficulty: 2,
    category: 'grey',
    mechanicalFunction: 'Must end in same room as Juliet',
    dependencies: ['Juliet'],
    worksWellWith: [],
    incompatibleWith: [],
  },
  'Juliet': {
    name: 'Juliet',
    team: 'grey',
    difficulty: 2,
    category: 'grey',
    mechanicalFunction: 'Must end in same room as Romeo',
    dependencies: ['Romeo'],
    worksWellWith: [],
    incompatibleWith: [],
  },
  'Sniper': {
    name: 'Sniper',
    team: 'grey',
    difficulty: 3,
    category: 'grey',
    mechanicalFunction: 'Target mechanic; must identify and "kill" the Target',
    dependencies: ['Target', 'Decoy'],
    worksWellWith: [],
    incompatibleWith: [],
  },
  'Target': {
    name: 'Target',
    team: 'grey',
    difficulty: 2,
    category: 'grey',
    mechanicalFunction: 'Target mechanic; must avoid being identified by Sniper',
    dependencies: ['Sniper', 'Decoy'],
    worksWellWith: [],
    incompatibleWith: [],
  },
  'Decoy': {
    name: 'Decoy',
    team: 'grey',
    difficulty: 2,
    category: 'grey',
    mechanicalFunction: 'Target mechanic; wins if Sniper "kills" them',
    dependencies: ['Sniper', 'Target'],
    worksWellWith: [],
    incompatibleWith: [],
  },
  'Intern': {
    name: 'Intern',
    team: 'grey',
    difficulty: 2,
    category: 'grey',
    mechanicalFunction: 'Workplace mechanic; wins if Rival is not leader',
    dependencies: [],
    worksWellWith: ['Rival'],
    incompatibleWith: [],
  },
  'Rival': {
    name: 'Rival',
    team: 'grey',
    difficulty: 2,
    category: 'grey',
    mechanicalFunction: 'Workplace mechanic; wins if Intern is in other room',
    dependencies: [],
    worksWellWith: ['Intern'],
    incompatibleWith: [],
  },
  'Survivor': {
    name: 'Survivor',
    team: 'grey',
    difficulty: 1,
    category: 'grey',
    mechanicalFunction: 'Must not gain "dead" condition',
    dependencies: [],
    worksWellWith: [],
    incompatibleWith: [],
  },
  'Victim': {
    name: 'Victim',
    team: 'grey',
    difficulty: 1,
    category: 'grey',
    mechanicalFunction: 'Must gain "dead" condition',
    dependencies: [],
    worksWellWith: [],
    incompatibleWith: [],
  },
  
  // Advanced/Acting/Experimental
  'Zombie': {
    name: 'Zombie',
    team: 'green',
    difficulty: 3,
    category: 'condition',
    mechanicalFunction: 'Viral; spreads condition',
    dependencies: [],
    worksWellWith: ['Medic', 'Hunter'],
    incompatibleWith: [],
    isViral: true,
  },
  'Mummy': {
    name: 'Mummy',
    team: 'grey',
    difficulty: 3,
    category: 'condition',
    mechanicalFunction: 'Prevents players from speaking',
    dependencies: [],
    worksWellWith: [],
    incompatibleWith: [],
  },
  'Hot Potato': {
    name: 'Hot Potato',
    team: 'grey',
    difficulty: 3,
    category: 'condition',
    mechanicalFunction: 'Role trades upon card share',
    dependencies: [],
    worksWellWith: [],
    incompatibleWith: [],
  },
  'Ambassador': {
    name: 'Ambassador',
    team: 'both',
    difficulty: 2,
    category: 'movement',
    mechanicalFunction: 'Can move freely between rooms',
    dependencies: [],
    worksWellWith: [],
    incompatibleWith: [],
    affectsHostageCount: true,
  },
  'Mime': {
    name: 'Mime',
    team: 'both',
    difficulty: 2,
    category: 'acting',
    mechanicalFunction: 'Cannot speak',
    dependencies: [],
    worksWellWith: [],
    incompatibleWith: [],
    isActing: true,
  },
  'Clown': {
    name: 'Clown',
    team: 'both',
    difficulty: 2,
    category: 'acting',
    mechanicalFunction: 'Must always smile',
    dependencies: [],
    worksWellWith: [],
    incompatibleWith: [],
    isActing: true,
  },
  'Blind': {
    name: 'Blind',
    team: 'both',
    difficulty: 3,
    category: 'acting',
    mechanicalFunction: 'Must keep eyes closed',
    dependencies: [],
    worksWellWith: [],
    incompatibleWith: [],
    isActing: true,
  },
  'Angel': {
    name: 'Angel',
    team: 'both',
    difficulty: 2,
    category: 'acting',
    mechanicalFunction: 'Honest condition; must tell truth',
    dependencies: [],
    worksWellWith: ['Demon'],
    incompatibleWith: ['Demon'],
    isActing: true,
  },
  'Demon': {
    name: 'Demon',
    team: 'both',
    difficulty: 2,
    category: 'acting',
    mechanicalFunction: 'Liar condition; must lie',
    dependencies: [],
    worksWellWith: ['Angel'],
    incompatibleWith: ['Angel'],
    isActing: true,
  },
  'Paparazzo': {
    name: 'Paparazzo',
    team: 'both',
    difficulty: 2,
    category: 'info',
    mechanicalFunction: 'Can force reveals of celebrities',
    dependencies: [],
    worksWellWith: [],
    incompatibleWith: [],
  },
  'Medic': {
    name: 'Medic',
    team: 'both',
    difficulty: 2,
    category: 'support',
    mechanicalFunction: 'Can heal conditions',
    dependencies: [],
    worksWellWith: ['Zombie'],
    incompatibleWith: [],
  },
  'Private Investigator': {
    name: 'Private Investigator',
    team: 'grey',
    difficulty: 3,
    category: 'grey',
    mechanicalFunction: 'Must correctly name buried card at end',
    dependencies: [],
    worksWellWith: [],
    incompatibleWith: [],
  },
};

// Helper function to get role metadata
export function getRoleMetadata(name: string): RoleMetadata | null {
  return ROLE_METADATA[name] || null;
}

// Helper function to check if role exists
export function hasRoleMetadata(name: string): boolean {
  return name in ROLE_METADATA;
}

// Get all role names
export function getAllRoleNames(): string[] {
  return Object.keys(ROLE_METADATA);
}
